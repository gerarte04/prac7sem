# Отчет по лабораторной работе

## Нелинейное уравнение теплопроводности

### 1. Постановка задачи (Image 7)
Рассматривается нелинейное уравнение теплопроводности:
$$ c(u) u_t = (k(u) u_x)_x $$
Принимаем $c(u) = 1$, тогда:
$$ u_t = (k(u) u_x)_x, \quad 0 < x < L, \quad t > 0 $$
где $k(u)$ — коэффициент теплопроводности, зависящий от температуры $u(x, t)$.
Вид коэффициента:
$$ k(u) = 1 + \beta u^\gamma $$

**Граничные условия:**
$$ u(0, t) = 0, \quad u(L, t) = 0 $$
**Начальное условие:**
$$ u(x, 0) = \sin\left(\frac{\pi x}{L}\right) $$

### 2. Дискретизация (Image 7)
Разбиваем отрезок $[0, L]$ равномерной сеткой:
$$ x_i = i h, \quad i = 0, 1, \dots, N, \quad h = \frac{L}{N} $$
По времени:
$$ t^n = n \tau, \quad n = 0, 1, 2, \dots, \quad \tau = \Delta t $$
Обозначение сеточной функции: $u_i^n \approx u(x_i, t^n)$.

### 3. Разностная схема (Image 7, Image 1)
Используем неявную схему. Производную по времени аппроксимируем разностью назад:
$$ u_t \approx \frac{u_i^{n+1} - u_i^n}{\tau} $$

**Аппроксимация потока (почему среднее арифметическое?):**
Пространственный оператор строится интегро-интерполяционным методом (методом баланса). Уравнение интегрируется по ячейке $[x_{i-1/2}, x_{i+1/2}]$. Поток тепла через грань ячейки $x_{i+1/2}$ записывается как:
$$ W = -k(u) \frac{\partial u}{\partial x} $$
В разностном виде поток аппроксимируется как:
$$ W_{i+1/2} \approx -k_{i+1/2} \frac{u_{i+1} - u_i}{h} $$
Коэффициент $k_{i+1/2}$ должен аппроксимировать значение $k(u)$ на грани ячейки $x_{i+1/2}$. Поскольку узлы сетки $x_i$ и $x_{i+1}$ равноудалены от грани $x_{i+1/2}$, значение $u(x_{i+1/2})$ можно приблизить средним арифметическим $\frac{u_i + u_{i+1}}{2}$ (с точностью $O(h^2)$).
Следовательно, для гладких коэффициентов $k(u)$ используется **среднее арифметическое**:
$$ k_{i+1/2} = \frac{k(u_{i+1}) + k(u_i)}{2} $$
Это обеспечивает второй порядок аппроксимации потока по пространству.

**Полная неявная схема (1):**
$$ \frac{u_i^{n+1} - u_i^n}{\tau} = \frac{1}{h^2} \left[ k_{i+1/2}^{n+1} (u_{i+1}^{n+1} - u_i^{n+1}) - k_{i-1/2}^{n+1} (u_i^{n+1} - u_{i-1}^{n+1}) \right] $$
Схема нелинейна, так как $k$ зависит от искомого решения $u^{n+1}$.

### 4. Линеаризация (Метод Пикара) (Image 1)
Так как коэффициенты $k$ зависят от температуры, система разностных уравнений является нелинейной. Для её решения на каждом временном шаге применяется итерационный метод (метод простой итерации или метод Пикара).

Обозначим $y = u^{n+1}$ — искомое решение на новом слое, $\check{y} = u^n$ — известное решение.
Нелинейная схема имеет вид:
$$ \frac{y - \check{y}}{\tau} = (\bar{k}(y) y_{\bar{x}})_x $$
где $\bar{k}(y)$ — усредненный коэффициент теплопроводности.

Вводим итерации с номером $m = 0, 1, \dots$. Пусть $y^{(m)}$ — приближение к $y$.
Линеаризация заключается в "замораживании" коэффициента теплопроводности на предыдущей итерации. Уравнение для $(m+1)$-й итерации:
$$ \frac{y^{(m+1)} - \check{y}}{\tau} = (\bar{k}(y^{(m)}) y_{\bar{x}}^{(m+1)})_x $$
В индексной форме это уравнение (2):
$$ \frac{u_i^{(m+1)} - u_i^n}{\tau} = \frac{1}{h^2} \left[ k_{i+1/2}^{(m)} (u_{i+1}^{(m+1)} - u_i^{(m+1)}) - k_{i-1/2}^{(m)} (u_i^{(m+1)} - u_{i-1}^{(m+1)}) \right] $$
где коэффициент $k_{i \pm 1/2}^{(m)}$ вычисляется по значениям $u^{(m)}$:
$$ k_{i \pm 1/2}^{(m)} = \frac{k(u_{i \pm 1}^{(m)}) + k(u_i^{(m)})}{2} $$
Начальное приближение для итераций выбирается с предыдущего временного слоя: $u^{(0)} = u^n$.

### 5. Алгоритм решения (Прогонка) (Image 1)
Приводим линеаризованное уравнение к каноническому трехдиагональному виду относительно $u^{(m+1)}$:
$$ A_i u_{i-1}^{m+1} - C_i u_i^{m+1} + B_i u_{i+1}^{m+1} = -F_i $$
Коэффициенты прогонки:
$$ a_i = \frac{\tau}{h^2} k_{i-1/2}^{(m)}, \quad b_i = \frac{\tau}{h^2} k_{i+1/2}^{(m)}, \quad c_i = 1 + a_i + b_i, \quad d_i = u_i^n $$
Уравнение: $a_i u_{i-1}^{(m+1)} - c_i u_i^{(m+1)} + b_i u_{i+1}^{(m+1)} = -d_i$.
Граничные условия: $u_0^{m+1} = 0, \quad u_N^{m+1} = 0$.

### 6. Сходимость и устойчивость (Image 2, Image 3)

#### Критерий остановки итераций и обоснование сходимости
Процесс итераций Пикара останавливается при выполнении условия:
$$ ||u^{m+1} - u^m||_\infty < \epsilon $$
Сходимость итерационного процесса следует из теории сжимающих отображений (теорема Банаха). Согласно Самарскому (гл. IV, §10), итерации Пикара сходятся, если отображение $y = F(y)$ является сжимающим:
$$ ||F(y^{(1)}) - F(y^{(2)})|| \le q ||y^{(1)} - y^{(2)}||, \quad 0 \le q < 1 $$
Для рассматриваемой разностной схемы условие сжатия выполняется при достаточно малом шаге по времени $\tau$, если коэффициент теплопроводности $k(u)$ является неубывающей и липшицевой функцией:
$$ |k'(u)| \le M, \quad k(u) \ge k_0 > 0 $$

#### Доказательство энергетической устойчивости
Схема устойчива в энергетической норме $L_2$.
Умножим разностную схему скалярно на $u^{n+1}$.
Левая часть:
$$ (u^{n+1} - u^n, u^{n+1}) \ge \frac{1}{2} (||u^{n+1}||^2 - ||u^n||^2) $$
Правая часть (используя формулу Грина и положительность $k(u)$):
$$ (\Lambda(u^{n+1}) u^{n+1}, u^{n+1}) = - \sum_{i=1}^N k_{i-1/2} (u_{\bar{x}, i}^{n+1})^2 h \le 0 $$
Итог: $||u^{n+1}|| \le ||u^n||$. Схема безусловно устойчива.

#### Доказательство порядка аппроксимации $O(\tau + h^2)$
Рассмотрим невязку $\psi$ при подстановке точного решения $u(x, t)$ в разностную схему.
$$ \psi = \frac{u(x, t^{n+1}) - u(x, t^n)}{\tau} - \Lambda u(x, t^{n+1}) $$
1. **Аппроксимация по времени:**
Разлагаем $u(x, t^n)$ в ряд Тейлора в точке $t^{n+1}$:
$$ u(x, t^n) = u(x, t^{n+1}) - \tau \frac{\partial u}{\partial t}(x, t^{n+1}) + O(\tau^2) $$
Тогда разностная производная по времени:
$$ \frac{u^{n+1} - u^n}{\tau} = \frac{\partial u}{\partial t}(x, t^{n+1}) + O(\tau) $$
Это дает первый порядок по $\tau$.

2. **Аппроксимация по пространству:**
Рассмотрим поток $W_{i+1/2} = k_{i+1/2} \frac{u_{i+1} - u_i}{h}$. Разлагаем все величины относительно точки $x_{i+1/2}$.
$$ u_{i+1} - u_i = h \frac{\partial u}{\partial x}\bigg|_{i+1/2} + O(h^3) \implies \frac{u_{i+1} - u_i}{h} = \frac{\partial u}{\partial x}\bigg|_{i+1/2} + O(h^2) $$
$$ k_{i+1/2} = \frac{k(u_{i+1}) + k(u_i)}{2} = k(u(x_{i+1/2})) + O(h^2) $$
Произведение двух величин с точностью $O(h^2)$ дает поток с той же точностью:
$$ W_{i+1/2} = \left( k(u) \frac{\partial u}{\partial x} \right)\bigg|_{i+1/2} + O(h^2) $$
Теперь разностный оператор (производная потока):
$$ \frac{W_{i+1/2} - W_{i-1/2}}{h} = \frac{\partial}{\partial x} \left( k(u) \frac{\partial u}{\partial x} \right)\bigg|_{x_i} + O(h^2) $$
Это дает второй порядок по $h$.

**Итоговая погрешность аппроксимации:**
$$ \psi = \left( \frac{\partial u}{\partial t} - \frac{\partial}{\partial x} \left( k(u) \frac{\partial u}{\partial x} \right) \right) + O(\tau) + O(h^2) $$
Так как выражение в скобках равно нулю (исходное дифференциальное уравнение), то $\psi = O(\tau + h^2)$.

### 7. Эффекты локализации (Image 5)
В задаче с локализованным начальным возмущением (например, ступенька или импульс) и нелинейной теплопроводностью ($k(u) \sim u^\sigma$) физически должна наблюдаться конечная скорость распространения фронта тепловой волны.

**Сравнение поведения схем на графиках:**
1.  **Явная схема:**
    *   Значение $u_i^{n+1}$ зависит только от узлов $i, i-1, i+1$ предыдущего слоя.
    *   Область зависимости — треугольник.
    *   Влияние начального импульса распространяется не далее чем на один узел за шаг.
    *   **Вывод:** Наблюдается строгая локализация, фронт движется с конечной скоростью, что хорошо согласуется с физикой нелинейного процесса.

2.  **Неявная схема:**
    *   Значение $u_i^{n+1}$ определяется из системы уравнений (прогонки), куда входят все узлы слоя.
    *   Матрица системы связывает все неизвестные. Изменение правой части в одной точке мгновенно влияет на решение во всех точках сетки (обратная матрица плотная).
    *   **Вывод:** Неявная схема **не имеет строгой локализации**. На графиках можно заметить, что возмущение мгновенно "размазывается" по всей области (появляются малые ненулевые значения далеко от фронта), то есть скорость распространения численно бесконечна. Однако из-за затухания эти значения могут быть малы, но теоретически локализация нарушается. Это "глобальная область зависимости".

Тем не менее, неявная схема является абсолютно устойчивой и позволяет делать большие шаги по времени, в отличие от явной, которая ограничена жестким условием Куранта ($\tau \le h^2 / 2k$).

---

## Дополнительно: Уравнения мелкой воды (ЗСМ) (Image 6)
Рассматривается система законов сохранения (Shallow Water Equations):
$$ \begin{cases} \frac{\partial h}{\partial t} + \frac{\partial q}{\partial x} = 0 \\ \frac{\partial q}{\partial t} + \frac{\partial}{\partial x} \left( \frac{q^2}{h} + \frac{gh^2}{2} \right) = 0 \end{cases} $$
где $h(x,t)$ — высота столба воды, $q(x,t) = h u$ — расход.
**Задача Римана (разрыв плотины):**
Начальные условия ступенькой:
$$ h(x, 0) = \begin{cases} h_1, & x < x_0 \\ h_2, & x > x_0 \end{cases}, \quad h_1 > h_2 $$
